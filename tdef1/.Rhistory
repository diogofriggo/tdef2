source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
source('C:/Users/Diogo Friggo/Downloads/HandsOnProgrammingWithR.R', echo=TRUE)
seq(1,52,13)
seq(0,52,13)
seq(13,52,13)
Can.I.Do.This <- 2
Can.I.Do.This
a? <- 2
source('C:/Users/Diogo Friggo/Downloads/RDataScience.R')
source('C:/Users/Diogo Friggo/Downloads/RDataScience.R')
source('C:/Users/Diogo Friggo/Downloads/RDataScience.R')
source('C:/Users/Diogo Friggo/Downloads/RDataScience.R')
source('C:/Users/Diogo Friggo/Downloads/RDataScience.R')
#install.packages("tidyverse")
#library(tidyverse)
#install.packages(c("nycflights13", "gapminder", "Lahman"))
1+2
source('C:/Users/Diogo Friggo/Downloads/RDataScience.R')
source('C:/Users/Diogo Friggo/Downloads/RDataScience.R')
source('C:/Users/Diogo Friggo/Downloads/RDataScience.R')
#install.packages("tidyverse")
library(tidyverse)
#install.packages(c("nycflights13", "gapminder", "Lahman"))
#Sys.setenv(LANGUAGE = "en")
1+2
#tidyverse_update()
#dput(mtcars)
#install.packages("tidyverse")
library(tidyverse)
#install.packages(c("nycflights13", "gapminder", "Lahman"))
#Sys.setenv(LANGUAGE = "en")
1+2
#tidyverse_update()
#dput(mtcars)
#do cars with big engines use more fuel than cars with small engines
mpg
?mpg
ggplot(data=mpg, mapping=aes(x=displ, y=hwy))
ggplot(data=mpg) + geom_point(mapping=aes(x=displ, y=hwy))
ggplot(mpg) + geom_point(aes(displ, hwy))
ggplot(data=mpg)
nrow(mpg), ncol(mpg)
c(nrow(mpg), ncol(mpg))
length(mpg)
str(mpg)
ggplot(mpg) + geom_point(aes(hwy, cyl))
ggplot(mpg) + geom_point(aes(class, drv))
ggplot(mpg) + geom_point(aes(hwy, cyl, color=class))
ggplot(mpg) + geom_point(aes(displ, hwy, color=class))
ggplot(mpg) + geom_point(aes(displ, hwy, class))
ggplot(mpg) + geom_point(aes(displ, hwy, color=class))
ggplot(mpg) + geom_point(aes(displ, hwy, size=class))
ggplot(mpg) + geom_point(aes(displ, hwy, alpha=class))
ggplot(mpg) + geom_point(aes(displ, hwy, shape=class))
ggplot(mpg) + geom_point(aes(displ, hwy), color="blue")
ggplot(mpg) + geom_point(aes(displ, hwy), color="blue", size=4)
ggplot(mpg) + geom_point(aes(displ, hwy), color="blue", size=4, shape=2)
ggplot(mpg) + geom_point(aes(displ, hwy), color="blue", size=4, shape=0)
ggplot(mpg) + geom_point(aes(displ, hwy), color="blue", size=4, shape=1)
ggplot(mpg) + geom_point(aes(displ, hwy), color="blue", size=4, shape=3)
ggplot(mpg) + geom_point(aes(displ, hwy), color="blue", size=4, shape=4)
ggplot(mpg) + geom_point(aes(displ, hwy), color="blue", size=4, shape=4)
ggplot(mpg) + geom_point(aes(displ, hwy, color="blue"))
ggplot(mpg) + geom_point(aes(displ, hwy))
?mpg
#continuous: displ, cty, hwy
#categorical: year, cyl, trans, drv, fl, class
ggplot(mpg) + geom_point(aes(displ, hwy, color=cty))
#continuous: displ, cty, hwy
#categorical: year, cyl, trans, drv, fl, class
ggplot(mpg) + geom_point(aes(displ, hwy, color=year))
#continuous: displ, cty, hwy
#categorical: year, cyl, trans, drv, fl, class
ggplot(mpg) + geom_point(aes(displ, hwy, color=cyl))
#continuous: displ, cty, hwy
#categorical: year, cyl, trans, drv, fl, class
ggplot(mpg) + geom_point(aes(displ, hwy, color=trans))
#continuous: displ, cty, hwy, year, cyl
#categorical: trans, drv, fl, class
ggplot(mpg) + geom_point(aes(displ, hwy, color=drv))
#continuous: displ, cty, hwy, year, cyl
#categorical: trans, drv, fl, class
ggplot(mpg) + geom_point(aes(displ, hwy, color=fl))
#continuous: displ, cty, hwy, year, cyl
#categorical: trans, drv, fl, class
ggplot(mpg) + geom_point(aes(displ, hwy, color=displ))
#continuous: displ, cty, hwy, year, cyl
#categorical: trans, drv, fl, class
ggplot(mpg) + geom_point(aes(cty, hwy, color=displ))
ggplot(mpg) + geom_point(aes(cty, displ, color=displ))
ggplot(mpg) + geom_point(aes(cty, displ, color=displ, shape=displ))
ggplot(mpg) + geom_point(aes(cty, displ, color=class, shape=class))
ggplot(mpg) + geom_point(aes(cty, displ, color=class, size=class))
ggplot(mpg) + geom_point(aes(cty, displ, color=class, alpha=class))
ggplot(mpg) + geom_point(aes(cty, displ, color=class, alpha=cyl))
ggplot(mpg) + geom_point(aes(cty, displ, stroke=class))
ggplot(mpg) + geom_point(aes(cty, displ, stroke=cyl))
?geom_point
ggplot(mpg) + geom_point(aes(cty, displ, color=displ < 5))
?geom_point
vignette("ggplot2-specs")
ggplot(mpg) + geom_point(aes(cty, displ)) + facet_wrap(~class, nrow=2)
ggplot(mpg) + geom_point(aes(cty, displ)) + facet_grid(drv~cyl)
ggplot(mpg) + geom_point(aes(displ, hwy)) + facet_wrap(~class, nrow=2)
ggplot(mpg) + geom_point(aes(displ,hwy )) + facet_grid(drv~cyl)
ggplot(mpg) + geom_point(aes(displ,hwy )) + facet_grid(.~cyl)
ggplot(mpg) + geom_point(aes(displ, hwy)) + facet_wrap(~year)
ggplot(mpg) + geom_point(aes(displ, hwy)) + facet_wrap(~cyl)
ggplot(mpg) + geom_point(aes(displ, hwy)) + facet_wrap(~displ)
ggplot(mpg) + geom_point(aes(displ, hwy)) + facet_wrap(~hwy)
ggplot(mpg) + geom_point(aes(displ, hwy)) + facet_grid(cty~hwy)
#install.packages("tidyverse")
library(tidyverse)
ggplot(mpg) + geom_point(aes(displ,hwy )) + facet_grid(drv~cyl)
ggplot(mpg) + geom_point(aes(drv,cyl))
ggplot(mpg) + geom_point(aes(displ, hwy)) + facet_grid(drv~cyl)
ggplot(mpg) + geom_point(aes(displ,hwy )) + facet_grid(drv~.)
ggplot(mpg) + geom_smooth(aes(displ, hwy))
ggplot(mpg) + geom_smooth(aes(displ, hwy, linetype=drv))
ggplot(mpg) + geom_smooth(aes(displ, hwy, linetype=drv, color=drv)) + geom_point(aes(displ, hwy, color=drv))
ggplot(mpg) + geom_smooth(aes(displ, hwy, linetype=drv)) + geom_point(aes(displ, hwy, color=drv))
, color=drv
ggplot(mpg) + geom_smooth(aes(displ, hwy))
ggplot(mpg) + geom_smooth(aes(displ, hwy), group=drv)
ggplot(mpg) + geom_smooth(aes(displ, hwy, group=drv))
ggplot(mpg) + geom_smooth(aes(displ, hwy, linetype=drv))
ggplot(mpg) + geom_smooth(aes(displ, hwy, linetype=drv, color=drv), show.legend = F)
ggplot(mpg) + geom_smooth(aes(displ, hwy, linetype=drv, color=drv), show.legend = T)
ggplot(mpg, aes(displ, hwy, color=drv)) + geom_smooth(linetype=drv) + geom_point()
ggplot(mpg, mapping=aes(displ, hwy, color=drv)) + geom_smooth(linetype=drv) + geom_point()
ggplot(mpg, mapping=aes(displ, hwy, color=drv)) + geom_smooth() + geom_point()
ggplot(mpg, mapping=aes(displ, hwy, color=drv)) + geom_smooth(linetype=drv) + geom_point()
ggplot(mpg, mapping=aes(displ, hwy, color=drv)) + geom_smooth(aes(linetype=drv)) + geom_point()
ggplot(mpg, aes(displ, hwy, color=drv)) + geom_smooth(aes(linetype=drv)) + geom_point()
ggplot(mpg, aes(displ, hwy)) + geom_point(color=class) + geom_smooth()
ggplot(mpg, aes(displ, hwy)) + geom_point(aes(color=class)) + geom_smooth()
ggplot(mpg, aes(displ, hwy)) + geom_point(aes(color=class)) + geom_smooth(data=filter(mpg, class="subcompact"), se=F)
ggplot(mpg, aes(displ, hwy)) + geom_point(aes(color=class)) + geom_smooth(data=filter(mpg, class="subcompact"), se=FALSE)
ggplot(mpg, aes(displ, hwy)) +
geom_point(aes(color=class)) +
geom_smooth(
data=filter(mpg, class="subcompact"),
se=FALSE)
ggplot(mpg, aes(displ, hwy)) +
geom_point(aes(color=class)) +
geom_smooth(
data=filter(mpg, class == "subcompact"),
se=FALSE)
ggplot(mpg, aes(displ, hwy)) +
geom_point(aes(color=class)) +
geom_smooth(
data=filter(mpg, class == "subcompact"),
se=FALSE)
ggplot(mpg, aes(displ, hwy)) + geom_point(aes(color=class)) + geom_smooth(data=filter(mpg, class == "subcompact"), se=FALSE)
ggplot(mpg, aes(displ, hwy)) + geom_point(aes(color=class)) + geom_smooth(data=filter(mpg, class == "midsize"), se=FALSE)
ggplot(mpg, aes(displ, hwy)) + geom_chart()
?'ggplot chart'
??'ggplot chart'
ggplot(mpg, aes(displ, hwy)) + geom_bar()
ggplot(mpg, aes(displ)) + geom_bar()
ggplot(mpg, aes(displ)) + geom_boxplot()
ggplot(mpg, aes(displ, hwy)) + geom_area()
ggplot(mpg, aes(displ, hwy)) + geom_boxplot()
ggplot(mpg, aes(displ, hwy)) + geom_histogram()
ggplot(mpg, aes(displ)) + geom_histogram()
ggplot(mpg, aes(displ, hwy, color=drv)) + geom_point() + geom_smooth(se=F)
ggplot(mpg, aes(displ, hwy, color=drv)) + geom_point() + geom_smooth(se=F)
ggplot(mpg, aes(displ, hwy, color=drv)) + geom_point() + geom_smooth()
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point() +
geom_smooth()
ggplot() +
geom_point(
data = mpg,
mapping = aes(x = displ, y = hwy)
) +
geom_smooth(
data = mpg,
mapping = aes(x = displ, y = hwy)
)
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point() +
geom_smooth()
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
geom_point() +
geom_smooth()
ggplot(mpg, aes(displ, hwy)) + geom_point() + geom_smooth(se=F)
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2) + geom_smooth(se=F)
ggplot(mpg, aes(displ, hwy)) + geom_point(size=4) + geom_smooth(se=F)
ggplot(mpg, aes(displ, hwy)) + geom_point(size=3) + geom_smooth(se=F)
ggplot(mpg, aes(displ, hwy)) + geom_point() + geom_smooth(se=F)
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2) + geom_smooth(se=F)
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2) + geom_smooth(se=F, size=2)
ggplot(mpg, aes(displ, hwy), size=2) + geom_point() + geom_smooth(se=F)
ggplot(mpg, aes(displ, hwy), size=4) + geom_point() + geom_smooth(se=F)
ggplot(mpg, aes(displ, hwy, size=4)) + geom_point() + geom_smooth(se=F)
ggplot(mpg, aes(displ, hwy, size=2)) + geom_point() + geom_smooth(se=F)
ggplot(mpg, aes(displ, hwy, size=1)) + geom_point() + geom_smooth(se=F)
ggplot(mpg, aes(displ, hwy), size=1) + geom_point() + geom_smooth(se=F)
ggplot(mpg, aes(displ, hwy), size=10) + geom_point() + geom_smooth(se=F)
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2) + geom_smooth(se=F)
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2) + geom_smooth(se=F,size=2)
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2) + geom_smooth(se=F,size=2,aes(group=drv))
ggplot(mpg, aes(displ, hwy, color=drv)) + geom_point(size=2) + geom_smooth(se=F,size=2,aes(group=drv))
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2, color=drv) + geom_smooth(se=F,size=2))
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2, color=drv) + geom_smooth(se=F,size=2)
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2, aes(color=drv)) + geom_smooth(se=F,size=2)
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2, aes(color=drv)) + geom_smooth(se=F,size=2,aes(group=drv))
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2, aes(color=drv)) + geom_smooth(se=F,size=2,aes(linetype=drv))
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2, aes(color=drv)) + geom_smooth(se=F,size=1,aes(linetype=drv))
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2, aes(color=drv), stroke=2)
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2, aes(color=drv), border=2)
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2, aes(fill=drv), color="white", shape=21)
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2, aes(fill=drv), color="white", shape=21, stroke=5)
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2, aes(fill=drv), color="white", shape=21, stroke=2)
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2, aes(fill=drv), color="white", shape=21, stroke=3)
ggplot(mpg, aes(displ, hwy)) + geom_point(size=2, aes(fill=drv), color="white", shape=21, stroke=2)
ggplot(mpg, aes(displ, hwy)) + geom_point(size=4, aes(fill=drv), color="white", shape=21, stroke=2)
era5 %>%
mutate(hour=hour(`Time(UTC)`, tz='UTC'), month=month(Date,label=TRUE, abbr=FALSE)) #%>%
library(tidyverse)
era5 <- read_table2(path, skip=9, comment="--")
path <- 'C:/Users/Diogo Friggo/Downloads/nDani/250252 Cataventos Sento Se/04.WindAnalysis/02.WindApp 5.1.120.0/05.LongTerm/01.Inputs/SentoSe_ERA5.txt'
library(lubridate)
era5 %>%
mutate(hour=hour(`Time(UTC)`, tz='UTC'), month=month(Date,label=TRUE, abbr=FALSE)) #%>%
era5 <- read_table2(path, skip=9, comment="--")
library(lubridate)
era5 %>%
mutate(hour=hour(`Time(UTC)`, tz='UTC'), month=month(Date,label=TRUE, abbr=FALSE)) #%>%
era5 %>%
mutate(hour=hour(`Time(UTC)`), month=month(Date,label=TRUE, abbr=FALSE), tz=tz(hour)) #%>%
grep("Brazil",OlsonNames(),value=TRUE)
era5 %>%
mutate(stamp=ymd_hms(paste(Date, `Time(UTC)`), tz='Brazil/East'))# %>%
era5 %>%
mutate(stamp=force_tz(ymd_hms(paste(Date, `Time(UTC)`)),tzone='Brazil/East'))# %>%
era5 %>%
mutate(stamp=with_tz(ymd_hms(paste(Date, `Time(UTC)`)),tzone='Brazil/East'))# %>%
era5[3:,] %>%
mutate(stamp=with_tz(ymd_hms(paste(Date, `Time(UTC)`)),tzone='Brazil/East'))# %>%
tail(era5,-3) %>%
mutate(stamp=with_tz(ymd_hms(paste(Date, `Time(UTC)`)),tzone='Brazil/East'))# %>%
tail(era5,-3) %>%
mutate(stamp=with_tz(ymd_hms(paste(Date, `Time(UTC)`)), tzone='Brazil/East')) %>%
mutate(hour=hour(stamp), month=month(stamp,label=TRUE, abbr=FALSE)) %>%
group_by(month, hour) %>%
summarize(speed = mean(c_ws, na.rm = T)) %>%
rename(`Mês`=month, Hora=hour, Velocidade=speed) %>%
ggplot() + geom_smooth(aes(Hora, Velocidade, color=`Mês`), se = F) + scale_x_discrete(limits=0:23)
ggsave('diurnal.png')
tail(era5,-3) %>%
mutate(stamp=with_tz(ymd_hms(paste(Date, `Time(UTC)`)), tzone='Brazil/East')) %>%
mutate(hour=hour(stamp), month=month(stamp,label=TRUE, abbr=FALSE)) %>%
group_by(month, hour) %>%
summarize(speed = mean(c_ws, na.rm = T)) %>%
rename(`Mês`=month, Hora=hour, Velocidade=speed) %>%
ggplot() + geom_smooth(aes(Hora, Velocidade, color=`Mês`), se = F) + scale_x_discrete(limits=0:23)
tail(era5,-3) %>%
mutate(stamp=with_tz(ymd_hms(paste(Date, `Time(UTC)`)), tzone='Brazil/East')) %>%
mutate(hour=hour(stamp), month=month(stamp,label=TRUE, abbr=FALSE)) %>%
group_by(month, hour) %>%
summarize(speed = mean(c_ws, na.rm = T)) %>%
rename(`Mês`=month, Hora=hour, Velocidade=speed) %>%
ggplot() + geom_smooth(aes(Hora, Velocidade, color=`Mês`), se = F) + scale_x_discrete(limits=0:23)
ggsave('diurnal.png')
setwd('C:/Users/Diogo Friggo/Downloads')
ggsave('diurnal.png')
tail(era5,-3) %>%
na.omit() %>%
mutate(stamp=with_tz(ymd_hms(paste(Date, `Time(UTC)`)), tzone='Brazil/East')) %>%
mutate(hour=hour(stamp), month=month(stamp,label=TRUE, abbr=FALSE)) %>%
group_by(month, hour) %>%
summarize(speed = mean(c_ws, na.rm = T)) %>%
rename(`Mês`=month, Hora=hour, Velocidade=speed) %>%
ggplot() + geom_smooth(aes(Hora, Velocidade, color=`Mês`), se = F) + scale_x_discrete(limits=0:23)
tail(era5,-3) %>%
#na.omit() %>%
mutate(stamp=with_tz(ymd_hms(paste(Date, `Time(UTC)`)), tzone='Brazil/East')) %>%
mutate(hour=hour(stamp), month=month(stamp,label=TRUE, abbr=FALSE)) %>%
group_by(month, hour) %>%
summarize(speed = mean(c_ws, na.rm = T)) %>%
rename(`Mês`=month, Hora=hour, Velocidade=speed) %>%
ggplot() + geom_smooth(aes(Hora, Velocidade, color=`Mês`), se = F) + scale_x_discrete(limits=0:23)
era5 %>%
na.omit() %>%
mutate(month=month(Date,label=TRUE, abbr=FALSE)) %>%
plot.windrose(spd = "c_ws", dir = "c_wd", spdres=2) +
theme(axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())
plot.windrose <- function(data,
spd,
dir,
spdres = 2,
dirres = 30,
spdmin = 2,
spdmax = 20,
spdseq = NULL,
palette = "YlGnBu",
countmax = NA,
debug = 0){
# Look to see what data was passed in to the function
if (is.numeric(spd) & is.numeric(dir)){
# assume that we've been given vectors of the speed and direction vectors
data <- data.frame(spd = spd,
dir = dir)
spd = "spd"
dir = "dir"
} else if (exists("data")){
# Assume that we've been given a data frame, and the name of the speed
# and direction columns. This is the format we want for later use.
}
# Tidy up input data ----
n.in <- NROW(data)
dnu <- (is.na(data[[spd]]) | is.na(data[[dir]]))
data[[spd]][dnu] <- NA
data[[dir]][dnu] <- NA
# figure out the wind speed bins ----
if (missing(spdseq)){
spdseq <- seq(spdmin,spdmax,spdres)
} else {
if (debug >0){
cat("Using custom speed bins \n")
}
}
# get some information about the number of bins, etc.
n.spd.seq <- length(spdseq)
n.colors.in.range <- n.spd.seq - 1
# create the color map
spd.colors <- colorRampPalette(brewer.pal(min(max(3,
n.colors.in.range),
min(9,
n.colors.in.range)),
palette))(n.colors.in.range)
if (max(data[[spd]],na.rm = TRUE) > spdmax){
spd.breaks <- c(spdseq,
max(data[[spd]],na.rm = TRUE))
spd.labels <- c(paste(c(spdseq[1:n.spd.seq-1]),
'-',
c(spdseq[2:n.spd.seq])),
paste(spdmax,
"-",
max(data[[spd]],na.rm = TRUE)))
spd.colors <- c(spd.colors, "grey50")
} else{
spd.breaks <- spdseq
spd.labels <- paste(c(spdseq[1:n.spd.seq-1]),
'-',
c(spdseq[2:n.spd.seq]))
}
data$spd.binned <- cut(x = data[[spd]],
breaks = spd.breaks,
labels = spd.labels,
ordered_result = TRUE)
# clean up the data
data. <- na.omit(data)
# figure out the wind direction bins
dir.breaks <- c(-dirres/2,
seq(dirres/2, 360-dirres/2, by = dirres),
360+dirres/2)
dir.labels <- c(paste(360-dirres/2,"-",dirres/2),
paste(seq(dirres/2, 360-3*dirres/2, by = dirres),
"-",
seq(3*dirres/2, 360-dirres/2, by = dirres)),
paste(360-dirres/2,"-",dirres/2))
dir.labels <- c(seq(0,360,dirres),360)
#dir.labels <- c(dir.labels,tail(dir.labels,1))
# assign each wind direction to a bin
dir.binned <- cut(data[[dir]],
breaks = dir.breaks,
ordered_result = TRUE)
levels(dir.binned) <- dir.labels
data$dir.binned <- dir.binned
# Run debug if required ----
if (debug>0){
cat(dir.breaks,"\n")
cat(dir.labels,"\n")
cat(levels(dir.binned),"\n")
}
# deal with change in ordering introduced somewhere around version 2.2
if(packageVersion("ggplot2") > "2.2"){
cat("Hadley broke my code\n")
data$spd.binned = with(data, factor(spd.binned, levels = rev(levels(spd.binned))))
spd.colors = rev(spd.colors)
}
# create the plot ----
p.windrose <- ggplot(data = data,
aes(x = dir.binned,
fill = spd.binned)) +
geom_bar() +
scale_x_discrete(drop = FALSE,
labels = waiver()) +
coord_polar(start = -((dirres/2)/360) * 2*pi) +
scale_fill_manual(name = "Velocidade (m/s)",
values = spd.colors,
drop = FALSE) +
theme(axis.title.x = element_blank())
# adjust axes if required
if (!is.na(countmax)){
p.windrose <- p.windrose +
ylim(c(0,countmax))
}
# print the plot
print(p.windrose)
# return the handle to the wind rose
return(p.windrose)
}
library(tidyverse)
path <- 'C:/Users/Diogo Friggo/Downloads/nDani/250252 Cataventos Sento Se/04.WindAnalysis/02.WindApp 5.1.120.0/05.LongTerm/01.Inputs/SentoSe_ERA5.txt'
era5 <- read_table2(path, skip=9, comment="--")
library(lubridate)
era5 %>%
na.omit() %>%
mutate(month=month(Date,label=TRUE, abbr=FALSE)) %>%
plot.windrose(spd = "c_ws", dir = "c_wd", spdres=2) +
theme(axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())
era5 %>%
na.omit() %>%
mutate(month=month(Date,label=TRUE, abbr=FALSE)) %>%
plot.windrose(spd = "c_ws", dir = "c_wd", spdres=2) +
theme(axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())
# WindRose.R
require(ggplot2)
require(RColorBrewer)
era5 %>%
na.omit() %>%
mutate(month=month(Date,label=TRUE, abbr=FALSE)) %>%
plot.windrose(spd = "c_ws", dir = "c_wd", spdres=2) +
theme(axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())
era5 %>%
na.omit() %>%
mutate(month=month(Date,label=TRUE, abbr=FALSE)) %>%
plot.windrose(spd = "c_ws", dir = "c_wd", spdres=2) +
theme(axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())
era5 %>%
#na.omit() %>%
mutate(month=month(Date,label=TRUE, abbr=FALSE)) %>%
plot.windrose(spd = "c_ws", dir = "c_wd", spdres=2) +
theme(axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())
era5 %>%
na.omit()# %>%
era5 %>%
select(1:3) %>%
na.omit()# %>%
source('C:/Users/Diogo Friggo/Downloads/windrose.R', echo=TRUE)
era5 %>%
select(1:3)# %>%
era5 #%>%
era5 %>%
mutate(month=month(Date,label=TRUE, abbr=FALSE)) %>%
plot.windrose(spd = "c_ws", dir = "c_wd", spdres=2) +
theme(axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())
era5 %>%
filter(is.na("c_wd"))
era5 %>%
filter(is.na("c_ws"))
era5 %>%
filter(is.na("Date"))
era5 %>%
filter(is.na(Date))
era5 %>%
filter(is.na(c_ws))
era5 %>%
filter(is.na(c_wd))
era5 %>%
mutate(month=month(Date,label=TRUE, abbr=FALSE)) %>%
plot.windrose(spd = "c_ws", dir = "c_wd", spdres=2, spdmin=0) +
theme(axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())
era5 %>%
mutate(month=month(Date,label=TRUE, abbr=FALSE)) %>%
plot.windrose(spd = "c_ws", dir = "c_wd", spdmin=0) +
facet_wrap(~month) +
theme(axis.text.x = element_blank(), axis.title.x = element_blank(), axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())
ggsave('windrose_monthly.png')
era5 %>%
mutate(month=month(Date,label=TRUE, abbr=FALSE)) %>%
plot.windrose(spd = "c_ws", dir = "c_wd", spdmin=0) +
theme(axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())
ggsave('windrose.png')
setwd('C:/Users/Diogo Friggo/Downloads')
era5 %>%
mutate(month=month(Date,label=TRUE, abbr=FALSE)) %>%
plot.windrose(spd = "c_ws", dir = "c_wd", spdmin=0) +
facet_wrap(~month) +
theme(axis.text.x = element_blank(), axis.title.x = element_blank(), axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())
ggsave('windrose_monthly.png')
era5 %>%
mutate(month=month(Date,label=TRUE, abbr=FALSE)) %>%
plot.windrose(spd = "c_ws", dir = "c_wd", spdmin=0) +
theme(axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())
ggsave('windrose.png')
